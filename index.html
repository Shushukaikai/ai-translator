<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>AIè¯­éŸ³ç¿»è¯‘åŠ©æ‰‹</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-4">
  <h1 class="text-xl mb-4">ğŸ¤ AIè¯­éŸ³ç¿»è¯‘åŠ©æ‰‹</h1>
  <button id="recBtn" class="bg-green-500 text-white px-4 py-2 rounded mb-4">ç‚¹å‡»å¼€å§‹è¯´è¯</button>
  <div id="output" class="mb-2"></div>
  <div id="translation" class="mb-4 font-bold"></div>

  <script>
    const btn = document.getElementById('recBtn');
    const output = document.getElementById('output');
    const translation = document.getElementById('translation');

    const recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    recognition.lang = 'zh-CN'; // å¯ä»¥æ ¹æ®éœ€è¦è®¾ç½®æˆ 'en-US'
    recognition.interimResults = false;

    btn.onclick = () => {
      recognition.start();
    };

    recognition.onresult = async (event) => {
      const text = event.results[0][0].transcript;
      output.innerText = 'ä½ è¯´ï¼š' + text;

      const trans_type = /[\u4e00-\u9fa5]/.test(text) ? "zh2en" : "en2zh";

      const res = await fetch('https://api.interpreter.caiyunai.com/v1/translator', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
          'X-Authorization': 'token ttbj0nragxf2dxur8u4o'  // ğŸ‘ˆ æ”¹æˆä½ è‡ªå·±çš„ token
        },
        body: JSON.stringify({
          source: text,
          trans_type,
          request_id: "demo"
        })
      });

      const data = await res.json();
      translation.innerText = 'ç¿»è¯‘ï¼š' + data.target;

      const utter = new SpeechSynthesisUtterance(data.target);
      utter.lang = trans_type === 'zh2en' ? 'en-US' : 'zh-CN';
      speechSynthesis.speak(utter);
    };
  </script>
</body>
</html>
